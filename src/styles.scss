$itemsToInvert: "\
  img,video,object,embed,iframe,canvas,\
  [data-sdm-bg-color=dark][data-sdm-size=sm],\
  [data-sdm-bg-color=dark][data-sdm-size=md],\
  [data-sdm-bg-color=dark][data-sdm-size=lg],\
  [data-sdm-bg-color=medium][data-sdm-size=xs],\
  [data-sdm-bg-color=medium][data-sdm-size=sm],\
  [id*=yandex_rtb],\
  [style*='url('],\
  [data-sdm-emoji],\
";

@layer da-base {
  html[data-sdm="on"] {
    &[data-sdm-text-color="both"] body,
    &[data-sdm-text-color="body"] body {
      color: #000;
    }

    &[data-sdm-back-color="both"] body,
    &[data-sdm-back-color="body"] body {
      background: #fff;
    }

    // have to reset because color-scheme=dark changes some input colors
    // https://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css
    input,
    select,
    button,
    textarea {
      color: #000;
      background: #fff;
    }
  }
}

html[data-sdm="on"] {
  // 0.9 for lighter grayish
  filter: invert(0.91) hue-rotate(180deg) !important;

  body {
    #{$itemsToInvert} {
      filter: invert(1) hue-rotate(180deg) brightness(1.1) !important;

      * {
        filter: initial !important;
      }
    }

    :fullscreen {
      filter: initial !important;
    }
  }
}

// needed for detecting system color changes
[data-sdm-scheme="dark"] {
  color-scheme: dark !important;
}
[data-sdm-scheme="light"] {
  color-scheme: light !important;
}

// apply color scheme only when not detecting
html[data-sdm-dark-scroll="on"]:not([data-sdm-scheme]),
html[data-sdm-dark-scroll="on"]:not([data-sdm-scheme]) body {
  color-scheme: dark !important;
}
